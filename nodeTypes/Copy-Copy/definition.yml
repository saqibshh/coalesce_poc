fileVersion: 1
id: Copy
isDisabled: false
metadata:
  defaultStorageLocation: null
  error: null
  nodeMetadataSpec: |
    capitalized: Copy
    short: CPY
    plural: Copies
    tagColor: '#FF6B35'

    config:
    - groupName: Options
      items:
      - type: materializationSelector
        default: table
        options:
        - table
        - view
        isRequired: true

      - displayName: External URI
        attributeName: externalURI
        type: textBox
        syntax: sql
        isRequired: true
        description: "SQL query or static value for external URI (e.g., s3://bucket/path)"

      - displayName: Stage Name
        attributeName: stageName
        type: textBox
        syntax: sql
        isRequired: true
        description: "SQL query or static value for stage name"

      - displayName: File Type
        attributeName: fileType
        type: dropdownSelector
        default: CSV
        options:
        - CSV
        - JSON
        - PARQUET
        - AVRO
        isRequired: true

      - displayName: Field Delimiter
        attributeName: fieldDelim
        type: textBox
        default: ","
        isRequired: false

      - displayName: Skip Header
        attributeName: skipHeader
        type: textBox
        default: "1"
        isRequired: false

      - displayName: Subfolder
        attributeName: subfolder
        type: textBox
        isRequired: false
        description: "SQL query or static value for subfolder path"

      - displayName: Control Table Name
        attributeName: controlTableName
        type: textBox
        isRequired: false
        description: "Name of control table to read configuration from"

      - displayName: Control Table Schema
        attributeName: controlTableSchema
        type: textBox
        isRequired: false
        description: "Schema name for control table"

      - displayName: Enable Tests
        attributeName: testsEnabled
        type: toggleButton
        default: true

      - displayName: Pre-SQL
        attributeName: preSQL
        type: textBox
        syntax: sql
        isRequired: false

      - displayName: Post-SQL
        attributeName: postSQL
        type: textBox
        syntax: sql
        isRequired: false

    systemColumns:
    - displayName: LOAD_TIMESTAMP
      transform: current_timestamp()::timestamp_ntz
      dataType: TIMESTAMP_NTZ
      placement: end
      attributeName: isSystemLoadTimestamp

    - displayName: FILENAME
      transform: METADATA$FILENAME
      dataType: STRING
      placement: end
      attributeName: isSystemFilename

    - displayName: FILE_ROW_NUMBER
      transform: METADATA$FILE_ROW_NUMBER
      dataType: NUMBER
      placement: end
      attributeName: isSystemFileRowNumber

    - displayName: FILE_LAST_MODIFIED
      transform: METADATA$FILE_LAST_MODIFIED
      dataType: TIMESTAMP_NTZ
      placement: end
      attributeName: isSystemFileLastModified

    - displayName: SCAN_TIME
      transform: METADATA$START_SCAN_TIME
      dataType: TIMESTAMP_NTZ
      placement: end
      attributeName: isSystemScanTime

name: Copy
type: NodeType
